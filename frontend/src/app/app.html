<app-toast-container></app-toast-container>

<header class="top-bar">
  <h1>TCC Beverage - Item Management</h1>
</header>

<div class="container">
  <div class="input-section">
    <div class="input-wrapper">
      <input
        type="text"
        [formControl]="serialNumberControl"
        placeholder="Enter Serial Number (A-Z, 0-9)"
        maxlength="18"
        (keyup.enter)="addItem()"
        [disabled]="isAddingItem"
      />
      @if (serialNumberControl.touched && serialNumberControl.invalid) {
        <span class="error-message">
          @if (serialNumberControl.errors?.['required']) {
            Serial number is required
          } @else if (serialNumberControl.errors?.['maxlength']) {
            Maximum 18 characters allowed
          } @else if (serialNumberControl.errors?.['pattern']) {
            Only uppercase letters (A-Z) and numbers (0-9) allowed
          }
        </span>
      }
    </div>
    <button (click)="addItem()" [disabled]="serialNumberControl.invalid || isAddingItem">
      @if (isAddingItem) {
        <app-spinner [size]="SpinnerSize.Small"></app-spinner>
      } @else {
        Add Item
      }
    </button>
  </div>

  <ag-grid-angular
    class="grid"
    [theme]="theme"
    [columnDefs]="columnDefs"
    [context]="gridContext"
    [rowModelType]="rowModelType"
    [cacheBlockSize]="cacheBlockSize"
    [cacheOverflowSize]="cacheOverflowSize"
    [maxConcurrentDatasourceRequests]="maxConcurrentDatasourceRequests"
    [infiniteInitialRowCount]="infiniteInitialRowCount"
    [maxBlocksInCache]="maxBlocksInCache"
    (gridReady)="onGridReady($event)"
  >
  </ag-grid-angular>
</div>

<app-confirm-dialog
  [visible]="deleteDialogVisible"
  title="Confirm Delete"
  [message]="deleteDialogMessage"
  confirmText="Delete"
  (confirmed)="onDeleteConfirmed()"
  (cancelled)="closeDeleteDialog()"
>
</app-confirm-dialog>
