<app-toast-container></app-toast-container>

<header class="top-bar">
  <h1>{{ 'APP_TITLE' | translate }}</h1>
  <div class="lang-switcher">
    <button [class.active]="currentLang === 'en'" (click)="switchLang('en')">EN</button>
    <button [class.active]="currentLang === 'th'" (click)="switchLang('th')">TH</button>
  </div>
</header>

<div class="container">
  <div class="input-section">
    <div class="input-wrapper">
      <input
        type="text"
        [formControl]="serialNumberControl"
        [placeholder]="'INPUT_PLACEHOLDER' | translate"
        maxlength="16"
        (keyup.enter)="addItem()"
        [disabled]="isAddingItem"
      />
      @if (serialNumberControl.touched && serialNumberControl.invalid) {
        <span class="error-message">
          @if (serialNumberControl.errors?.['required']) {
            {{ 'VALIDATION.REQUIRED' | translate }}
          } @else if (serialNumberControl.errors?.['maxlength']) {
            {{ 'VALIDATION.MAX_LENGTH' | translate }}
          } @else if (serialNumberControl.errors?.['pattern']) {
            {{ 'VALIDATION.PATTERN' | translate }}
          }
        </span>
      }
    </div>
    <button (click)="addItem()" [disabled]="serialNumberControl.invalid || isAddingItem">
      @if (isAddingItem) {
        <app-spinner [size]="SpinnerSize.Small"></app-spinner>
      } @else {
        {{ 'BUTTON.ADD_ITEM' | translate }}
      }
    </button>
  </div>

  <ag-grid-angular
    class="grid"
    [theme]="theme"
    [columnDefs]="columnDefs"
    [context]="gridContext"
    [rowModelType]="rowModelType"
    [cacheBlockSize]="cacheBlockSize"
    [cacheOverflowSize]="cacheOverflowSize"
    [maxConcurrentDatasourceRequests]="maxConcurrentDatasourceRequests"
    [infiniteInitialRowCount]="infiniteInitialRowCount"
    [maxBlocksInCache]="maxBlocksInCache"
    (gridReady)="onGridReady($event)"
  >
  </ag-grid-angular>
</div>

<app-confirm-dialog
  [visible]="deleteDialogVisible"
  [title]="'DIALOG.CONFIRM_DELETE' | translate"
  [message]="deleteDialogMessage"
  [confirmText]="'BUTTON.DELETE' | translate"
  [cancelText]="'BUTTON.CANCEL' | translate"
  (confirmed)="onDeleteConfirmed()"
  (cancelled)="closeDeleteDialog()"
>
</app-confirm-dialog>
